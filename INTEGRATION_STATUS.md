# –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Supabase (Feb 2, 2026)

## ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

### 1. Backend –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ Supabase credentials –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –∏–∑ `/utils/supabase/info.tsx` (–∞–≤—Ç–æ—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª)
- ‚úÖ `@supabase/supabase-js` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ Supabase –∫–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω (`/src/utils/supabaseClient.ts`)
- ‚úÖ API —É—Ç–∏–ª–∏—Ç—ã —Å–æ–∑–¥–∞–Ω—ã (`/src/utils/jitsiAPI.ts`):
  - `createRoom()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
  - `joinRoom()` - –ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞
  - `getRoom()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–Ω–∞—Ç—ã
  - `endMeeting()` - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
- ‚úÖ **Edge Functions —Å–æ–∑–¥–∞–Ω—ã:**
  - `/supabase/functions/create-room/index.ts`
  - `/supabase/functions/join-room/index.ts`
- ‚è≥ **–¢–†–ï–ë–£–ï–¢–°–Ø –î–ï–ü–õ–û–ô** (—Å–º. `/DEPLOY_FUNCTIONS.md`)

### 2. HomePage –æ–±–Ω–æ–≤–ª—ë–Ω
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `createRoom` API
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "Start meeting" —Å–æ–∑–¥–∞—ë—Ç –∫–æ–º–Ω–∞—Ç—É –Ω–∞ backend
- ‚úÖ Loading —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å

### 3. JitsiPreJoin –æ–±–Ω–æ–≤–ª—ë–Ω
- ‚úÖ –ò–º–ø–æ—Ä—Ç `joinRoom` –∏–∑ API —É—Ç–∏–ª–∏—Ç
- ‚úÖ –í—ã–∑–æ–≤ `joinRoom()` –ü–ï–†–ï–î –∑–∞–ø—Ä–æ—Å–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞, roomName, role, identity
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ join data –≤ localStorage
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 4. –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –∫–æ–º–Ω–∞—Ç—É (FIXED!)
1. üîë –ü–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞ –æ—Ç Supabase Edge Function
2. üé• –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –∫–∞–º–µ—Ä—ã + –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ (–í–ú–ï–°–¢–ï, —Å–æ—Ö—Ä–∞–Ω—è—è user gesture)
3. üìç –ó–∞–ø—Ä–æ—Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ (–ø–æ—Å–ª–µ –º–µ–¥–∏–∞)
4. üì∏ –ó–∞—Ö–≤–∞—Ç —Ñ–æ—Ç–æ (—Ñ—Ä–æ–Ω—Ç + –∑–∞–¥)
5. üé• –ó–∞–ø—É—Å–∫ –≤–∏–¥–µ–æ–∑–∞–ø–∏—Å–∏
6. üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ join data –≤ localStorage
7. ‚û°Ô∏è –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∫–æ–º–Ω–∞—Ç—É

---

## ‚è≥ –û–°–¢–ê–õ–û–°–¨ –°–î–ï–õ–ê–¢–¨

### –ö–†–ò–¢–ò–ß–ù–û (–±–µ–∑ —ç—Ç–æ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

#### 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –≤ Edge Functions
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∞—à–∏ frontend API –≤—ã–∑–æ–≤—ã –æ–∂–∏–¥–∞—é—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã, –Ω–æ Edge Functions –º–æ–≥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥—Ä—É–≥–∏–µ.

**create-room endpoint –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:**
```typescript
{
  roomSlug: string;    // ‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å
  inviteLink: string;  // ‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å
  roomId: string;      // ‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å
}
```

**join-room endpoint –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:**
```typescript
{
  jitsiUrl: string;       // –Ω–∞–ø—Ä–∏–º–µ—Ä: "meet.jit.si"
  roomName: string;       // –Ω–∞–ø—Ä–∏–º–µ—Ä: "abc123"
  token: string;          // JWT —Ç–æ–∫–µ–Ω
  identity: string;       // UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  role: "moderator" | "participant";
  displayName: string;
}
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Edge Functions –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
2. –ï—Å–ª–∏ –Ω–µ—Ç - –∏—Å–ø—Ä–∞–≤–∏—Ç—å backend –∫–æ–¥
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ curl

#### 2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Jitsi Meet –≤ JitsiRoom
**–°–µ–π—á–∞—Å:** JitsiRoom –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç mock UI —Å —Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏

**–ù—É–∂–Ω–æ:**
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `@jitsi/web-sdk` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å iframe
- –ü—Ä–æ—á–∏—Ç–∞—Ç—å join data –∏–∑ localStorage
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Jitsi —Å JWT —Ç–æ–∫–µ–Ω–æ–º
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ

**–§–∞–π–ª:** `/src/app/components/JitsiRoom.tsx`

**–ö–æ–¥ –¥–ª—è JitsiRoom:**
```typescript
import { useEffect, useRef } from 'react';

export default function JitsiRoom({ roomName, userName }: Props) {
  const containerRef = useRef<HTMLDivElement>(null);
  
  useEffect(() => {
    // 1. –ü–æ–ª—É—á–∏—Ç—å join data –∏–∑ localStorage
    const joinDataStr = localStorage.getItem('jitsi_join_data');
    if (!joinDataStr) {
      console.error('‚ùå Join data not found!');
      return;
    }
    
    const joinData = JSON.parse(joinDataStr);
    console.log('üöÄ Join Data:', joinData);
    
    // 2. –°–æ–∑–¥–∞—Ç—å iframe —Å Jitsi
    const iframe = document.createElement('iframe');
    iframe.allow = 'camera; microphone; display-capture';
    iframe.src = `https://${joinData.jitsiUrl}/${joinData.roomName}?jwt=${joinData.token}`;
    iframe.style.width = '100%';
    iframe.style.height = '100%';
    iframe.style.border = 'none';
    
    containerRef.current?.appendChild(iframe);
    
    return () => {
      iframe.remove();
    };
  }, []);
  
  return <div ref={containerRef} className="w-full h-full" />;
}
```

---

### –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

#### 3. –£–ª—É—á—à–∏—Ç—å HomePage
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–π —Ä–µ–∂–∏–º "Join by code" (—Å–µ–π—á–∞—Å —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞–Ω–∏–µ)
- [ ] –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å invite link –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "Copy link"

#### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- [ ] –ö—Ä–∞—Å–∏–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ console.error
- [ ] Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è API –≤—ã–∑–æ–≤–æ–≤
- [ ] Fallback –¥–ª—è JWT —Ç–æ–∫–µ–Ω–∞

#### 5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [ ] –û—á–∏—Å—Ç–∫–∞ localStorage –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è JWT —Ç–æ–∫–µ–Ω–∞
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è room slug

---

### –ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

#### 6. End Meeting —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- [ ] –ö–Ω–æ–ø–∫–∞ "End Meeting" —Ç–æ–ª—å–∫–æ –¥–ª—è moderator
- [ ] –í—ã–∑–æ–≤ `endMeeting()` API
- [ ] –†–µ–¥–∏—Ä–µ–∫—Ç –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

#### 7. UI/UX
- [ ] Skeleton loaders
- [ ] –ê–Ω–∏–º–∞—Ü–∏–∏
- [ ] Toast notifications

---

## üìä –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

1. **–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã:**
   ```bash
   # HomePage ‚Üí –∫–Ω–æ–ø–∫–∞ "Start meeting"
   # –î–æ–ª–∂–µ–Ω –≤—ã–∑–≤–∞—Ç—å—Å—è createRoom API
   # –î–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ /prejoin/:slug
   ```

2. **–ü–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞:**
   ```bash
   # PreJoin ‚Üí –∫–Ω–æ–ø–∫–∞ "Join meeting"
   # –î–æ–ª–∂–µ–Ω –≤—ã–∑–≤–∞—Ç—å—Å—è joinRoom API
   # –î–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å token, role, roomName
   # –î–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ localStorage
   ```

3. **–ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:**
   ```bash
   # –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
   # 1. –ö–∞–º–µ—Ä–∞ + –ú–∏–∫—Ä–æ—Ñ–æ–Ω (–≤–º–µ—Å—Ç–µ!)
   # 2. –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Chrome Desktop —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç!
   ```

4. **–ü–µ—Ä–µ—Ö–æ–¥ –≤ –∫–æ–º–Ω–∞—Ç—É:**
   ```bash
   # –ü–æ—Å–ª–µ –≤—Å–µ—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
   # –î–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–π—Ç–∏ –≤ JitsiRoom
   # –î–æ–ª–∂–µ–Ω –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Jitsi
   ```

---

## üêõ –ò–ó–í–ï–°–¢–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### –ò–°–ü–†–ê–í–õ–ï–ù–û ‚úÖ
- ‚úÖ –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è "—Å—ä–µ–¥–∞–ª–∞" user gesture ‚Üí **FIXED**: –ú–µ–¥–∏–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –ü–ï–†–í–´–ú–ò
- ‚úÖ –ö–∞–º–µ—Ä–∞ –∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω –∑–∞–ø—Ä–∞—à–∏–≤–∞–ª–∏—Å—å –æ—Ç–¥–µ–ª—å–Ω–æ ‚Üí **FIXED**: –ó–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –í–ú–ï–°–¢–ï

### –û–°–¢–ê–õ–ò–°–¨ ‚ùå
- ‚ùå JitsiRoom –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å —Ä–µ–∞–ª—å–Ω—ã–º Jitsi
- ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç–≤–µ—Ç–∞ –æ—Ç Edge Functions
- ‚ùå –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–ß–µ–ª–æ–≤–µ–∫:** –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Edge Functions —á–µ—Ä–µ–∑ curl
2. **–ß–µ–ª–æ–≤–µ–∫:** –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
3. **AI:** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Jitsi Meet –≤ JitsiRoom
4. **–í–º–µ—Å—Ç–µ:** –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π flow –æ—Ç HomePage –¥–æ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∞

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ SUPABASE

- **URL:** `https://gcrbvrdbtszjqfhsardf.supabase.co`
- **Anon Key:** –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ `/utils/supabase/info.tsx`
- **Edge Functions:**
  - `POST /functions/v1/create-room`
  - `POST /functions/v1/join-room`
  - `GET /functions/v1/get-room/:slug`